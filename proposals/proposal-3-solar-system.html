<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Proposal 3: Solar System Explorer</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #000;
            color: white;
            overflow: hidden;
        }
        #container { width: 100vw; height: 100vh; position: relative; }
        #canvas { display: block; }
        .panel {
            position: absolute;
            background: rgba(10, 15, 30, 0.9);
            border: 1px solid rgba(255, 200, 100, 0.3);
            border-radius: 12px;
            padding: 20px;
            backdrop-filter: blur(10px);
        }
        .header {
            top: 20px; left: 20px;
            display: flex; gap: 20px; align-items: center;
        }
        h1 { font-size: 1.4rem; color: #ffd54f; }
        .badge { background: linear-gradient(135deg, #ff9800, #f44336); padding: 5px 12px; border-radius: 20px; font-size: 0.75rem; }
        .time-control {
            top: 20px; right: 20px; display: flex; gap: 10px; align-items: center;
        }
        .time-btn {
            width: 40px; height: 40px; border-radius: 50%; border: 2px solid rgba(255,200,100,0.5);
            background: rgba(255,200,100,0.1); color: #ffd54f; cursor: pointer;
            font-size: 1.2rem; transition: all 0.3s;
        }
        .time-btn:hover { background: rgba(255,200,100,0.3); transform: scale(1.1); }
        .time-display { font-size: 1.1rem; color: #ffd54f; min-width: 100px; text-align: center; }
        .planet-list {
            left: 20px; top: 100px; width: 200px;
        }
        .planet-item {
            display: flex; align-items: center; gap: 12px;
            padding: 10px; margin: 5px 0; border-radius: 8px;
            cursor: pointer; transition: all 0.3s;
        }
        .planet-item:hover { background: rgba(255,200,100,0.15); }
        .planet-item.active { background: rgba(255,200,100,0.25); border-left: 3px solid #ffd54f; }
        .planet-dot { width: 16px; height: 16px; border-radius: 50%; }
        .planet-name { flex: 1; }
        .info-panel {
            right: 20px; bottom: 20px; width: 300px;
        }
        .planet-info h2 { color: #ffd54f; font-size: 1.5rem; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .planet-icon { width: 30px; height: 30px; border-radius: 50%; }
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; }
        .stat-box { background: rgba(255,200,100,0.1); padding: 12px; border-radius: 8px; }
        .stat-label { font-size: 0.75rem; color: #90caf9; margin-bottom: 4px; }
        .stat-value { font-size: 1rem; font-weight: bold; color: white; }
        .orbit-toggle {
            bottom: 20px; left: 20px; display: flex; gap: 10px;
        }
        .toggle-btn {
            padding: 10px 16px; border: 1px solid rgba(255,200,100,0.4);
            border-radius: 20px; background: transparent; color: #ffd54f;
            cursor: pointer; font-size: 0.85rem; transition: all 0.3s;
        }
        .toggle-btn.active { background: rgba(255,200,100,0.3); }
        .scale-note {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.7); padding: 8px 16px; border-radius: 20px;
            font-size: 0.75rem; color: #90caf9;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="canvas"></canvas>

        <div class="panel header">
            <div>
                <h1>Solar System Explorer</h1>
                <p style="color: #90caf9; font-size: 0.85rem;">Lesson: Planetary Motion</p>
            </div>
            <span class="badge">PROPOSAL 3</span>
        </div>

        <div class="panel time-control">
            <button class="time-btn" onclick="timeScale = 0">⏸</button>
            <button class="time-btn" onclick="timeScale = 1">▶</button>
            <button class="time-btn" onclick="timeScale = 5">⏩</button>
            <button class="time-btn" onclick="timeScale = 20">⏩⏩</button>
            <div class="time-display" id="timeDisplay">Day 1</div>
        </div>

        <div class="panel planet-list" id="planetList"></div>

        <div class="panel info-panel">
            <div class="planet-info">
                <h2><div class="planet-icon" id="infoIcon"></div><span id="infoName">Select a Planet</span></h2>
                <div class="stat-grid">
                    <div class="stat-box">
                        <div class="stat-label">Distance from Sun</div>
                        <div class="stat-value" id="infoDist">-</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Orbital Period</div>
                        <div class="stat-value" id="infoPeriod">-</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Diameter</div>
                        <div class="stat-value" id="infoDiam">-</div>
                    </div>
                    <div class="stat-box">
                        <div class="stat-label">Moons</div>
                        <div class="stat-value" id="infoMoons">-</div>
                    </div>
                </div>
            </div>
        </div>

        <div class="panel orbit-toggle">
            <button class="toggle-btn active" id="toggleOrbits">Show Orbits</button>
            <button class="toggle-btn" id="toggleLabels">Show Labels</button>
            <button class="toggle-btn" id="toggleTrails">Show Trails</button>
        </div>

        <div class="scale-note">Note: Sizes and distances not to scale for visibility</div>
    </div>

    <script>
        const planets = [
            { name: 'Sun', color: 0xffcc00, size: 3, distance: 0, period: 0, realDist: '0', realPeriod: '-', diameter: '1.4M km', moons: '-', emissive: 0xff6600 },
            { name: 'Mercury', color: 0xaaaaaa, size: 0.3, distance: 5, period: 0.24, realDist: '58M km', realPeriod: '88 days', diameter: '4,879 km', moons: '0' },
            { name: 'Venus', color: 0xffcc88, size: 0.5, distance: 7, period: 0.62, realDist: '108M km', realPeriod: '225 days', diameter: '12,104 km', moons: '0' },
            { name: 'Earth', color: 0x4488ff, size: 0.5, distance: 9, period: 1, realDist: '150M km', realPeriod: '365 days', diameter: '12,742 km', moons: '1' },
            { name: 'Mars', color: 0xff6644, size: 0.4, distance: 11, period: 1.88, realDist: '228M km', realPeriod: '687 days', diameter: '6,779 km', moons: '2' },
            { name: 'Jupiter', color: 0xffaa66, size: 1.5, distance: 16, period: 11.86, realDist: '778M km', realPeriod: '12 years', diameter: '139,820 km', moons: '95' },
            { name: 'Saturn', color: 0xffdd88, size: 1.2, distance: 22, period: 29.46, realDist: '1.4B km', realPeriod: '29 years', diameter: '116,460 km', moons: '146', hasRings: true },
            { name: 'Uranus', color: 0x88ddff, size: 0.8, distance: 28, period: 84.01, realDist: '2.9B km', realPeriod: '84 years', diameter: '50,724 km', moons: '28' },
            { name: 'Neptune', color: 0x4466ff, size: 0.8, distance: 34, period: 164.8, realDist: '4.5B km', realPeriod: '165 years', diameter: '49,244 km', moons: '16' }
        ];

        let scene, camera, renderer;
        let planetMeshes = [], orbitLines = [], trails = [];
        let timeScale = 1;
        let elapsedDays = 0;
        let selectedPlanet = null;
        let showOrbits = true, showLabels = false, showTrails = false;

        function init() {
            scene = new THREE.Scene();
            camera = new THREE.PerspectiveCamera(60, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 30, 50);
            camera.lookAt(0, 0, 0);

            renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('canvas'), antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.setPixelRatio(window.devicePixelRatio);

            // Stars background
            const starsGeo = new THREE.BufferGeometry();
            const starPositions = [];
            for (let i = 0; i < 2000; i++) {
                starPositions.push(
                    (Math.random() - 0.5) * 500,
                    (Math.random() - 0.5) * 500,
                    (Math.random() - 0.5) * 500
                );
            }
            starsGeo.setAttribute('position', new THREE.Float32BufferAttribute(starPositions, 3));
            const starsMat = new THREE.PointsMaterial({ color: 0xffffff, size: 0.5 });
            scene.add(new THREE.Points(starsGeo, starsMat));

            // Create planets
            planets.forEach((planet, i) => {
                const geometry = new THREE.SphereGeometry(planet.size, 32, 32);
                const material = new THREE.MeshPhongMaterial({
                    color: planet.color,
                    emissive: planet.emissive || 0x000000,
                    emissiveIntensity: planet.emissive ? 0.5 : 0
                });
                const mesh = new THREE.Mesh(geometry, material);
                mesh.userData = { ...planet, index: i };
                planetMeshes.push(mesh);
                scene.add(mesh);

                // Saturn's rings
                if (planet.hasRings) {
                    const ringGeo = new THREE.RingGeometry(planet.size * 1.3, planet.size * 2, 64);
                    const ringMat = new THREE.MeshBasicMaterial({
                        color: 0xccaa77,
                        side: THREE.DoubleSide,
                        transparent: true,
                        opacity: 0.7
                    });
                    const ring = new THREE.Mesh(ringGeo, ringMat);
                    ring.rotation.x = Math.PI / 2.5;
                    mesh.add(ring);
                }

                // Orbit line
                if (planet.distance > 0) {
                    const orbitGeo = new THREE.BufferGeometry();
                    const orbitPoints = [];
                    for (let j = 0; j <= 64; j++) {
                        const angle = (j / 64) * Math.PI * 2;
                        orbitPoints.push(
                            Math.cos(angle) * planet.distance,
                            0,
                            Math.sin(angle) * planet.distance
                        );
                    }
                    orbitGeo.setAttribute('position', new THREE.Float32BufferAttribute(orbitPoints, 3));
                    const orbitLine = new THREE.Line(orbitGeo, new THREE.LineBasicMaterial({
                        color: 0x444466,
                        transparent: true,
                        opacity: 0.5
                    }));
                    orbitLines.push(orbitLine);
                    scene.add(orbitLine);

                    // Trail
                    const trailGeo = new THREE.BufferGeometry();
                    trailGeo.setAttribute('position', new THREE.Float32BufferAttribute(new Array(300).fill(0), 3));
                    const trail = new THREE.Line(trailGeo, new THREE.LineBasicMaterial({
                        color: planet.color,
                        transparent: true,
                        opacity: 0.5
                    }));
                    trail.visible = false;
                    trail.userData.positions = [];
                    trails.push(trail);
                    scene.add(trail);
                }
            });

            // Light from sun
            const sunLight = new THREE.PointLight(0xffffcc, 2, 100);
            sunLight.position.set(0, 0, 0);
            scene.add(sunLight);

            const ambient = new THREE.AmbientLight(0x222244, 0.3);
            scene.add(ambient);

            createPlanetList();
            setupControls();
            animate();
        }

        function createPlanetList() {
            const list = document.getElementById('planetList');
            planets.forEach((planet, i) => {
                const item = document.createElement('div');
                item.className = 'planet-item';
                item.innerHTML = `
                    <div class="planet-dot" style="background: #${planet.color.toString(16).padStart(6, '0')};"></div>
                    <span class="planet-name">${planet.name}</span>
                `;
                item.onclick = () => selectPlanet(i);
                list.appendChild(item);
            });
        }

        function selectPlanet(index) {
            selectedPlanet = index;
            const planet = planets[index];

            document.querySelectorAll('.planet-item').forEach((item, i) => {
                item.classList.toggle('active', i === index);
            });

            document.getElementById('infoIcon').style.background = '#' + planet.color.toString(16).padStart(6, '0');
            document.getElementById('infoName').textContent = planet.name;
            document.getElementById('infoDist').textContent = planet.realDist;
            document.getElementById('infoPeriod').textContent = planet.realPeriod;
            document.getElementById('infoDiam').textContent = planet.diameter;
            document.getElementById('infoMoons').textContent = planet.moons;

            // Focus camera on planet
            const mesh = planetMeshes[index];
            const targetPos = mesh.position.clone();
            targetPos.y = 10;
            targetPos.z += 15;
        }

        function setupControls() {
            // Toggle buttons
            document.getElementById('toggleOrbits').onclick = function() {
                showOrbits = !showOrbits;
                this.classList.toggle('active');
                orbitLines.forEach(line => line.visible = showOrbits);
            };

            document.getElementById('toggleLabels').onclick = function() {
                showLabels = !showLabels;
                this.classList.toggle('active');
            };

            document.getElementById('toggleTrails').onclick = function() {
                showTrails = !showTrails;
                this.classList.toggle('active');
                trails.forEach(trail => {
                    trail.visible = showTrails;
                    trail.userData.positions = [];
                });
            };

            // Mouse controls
            let isDragging = false, prevX, prevY;
            renderer.domElement.addEventListener('mousedown', (e) => { isDragging = true; prevX = e.clientX; prevY = e.clientY; });
            renderer.domElement.addEventListener('mouseup', () => isDragging = false);
            renderer.domElement.addEventListener('mousemove', (e) => {
                if (isDragging) {
                    const deltaX = e.clientX - prevX;
                    const deltaY = e.clientY - prevY;
                    camera.position.x = camera.position.x * Math.cos(deltaX * 0.005) - camera.position.z * Math.sin(deltaX * 0.005);
                    camera.position.z = camera.position.x * Math.sin(deltaX * 0.005) + camera.position.z * Math.cos(deltaX * 0.005);
                    camera.position.y += deltaY * 0.1;
                    camera.position.y = Math.max(5, Math.min(80, camera.position.y));
                    camera.lookAt(0, 0, 0);
                    prevX = e.clientX;
                    prevY = e.clientY;
                }
            });
            renderer.domElement.addEventListener('wheel', (e) => {
                const factor = e.deltaY > 0 ? 1.1 : 0.9;
                camera.position.multiplyScalar(factor);
                const dist = camera.position.length();
                if (dist < 15) camera.position.setLength(15);
                if (dist > 150) camera.position.setLength(150);
            });
        }

        function animate() {
            requestAnimationFrame(animate);

            elapsedDays += timeScale * 0.1;
            document.getElementById('timeDisplay').textContent = `Day ${Math.floor(elapsedDays)}`;

            planets.forEach((planet, i) => {
                if (planet.period > 0) {
                    const angle = (elapsedDays / (planet.period * 365)) * Math.PI * 2;
                    planetMeshes[i].position.x = Math.cos(angle) * planet.distance;
                    planetMeshes[i].position.z = Math.sin(angle) * planet.distance;

                    // Update trail
                    if (showTrails && trails[i - 1]) {
                        const trail = trails[i - 1];
                        trail.userData.positions.push(
                            planetMeshes[i].position.x,
                            planetMeshes[i].position.y,
                            planetMeshes[i].position.z
                        );
                        if (trail.userData.positions.length > 300) {
                            trail.userData.positions.splice(0, 3);
                        }
                        trail.geometry.setAttribute('position',
                            new THREE.Float32BufferAttribute(trail.userData.positions, 3)
                        );
                    }
                }
                planetMeshes[i].rotation.y += 0.01;
            });

            renderer.render(scene, camera);
        }

        window.addEventListener('resize', () => {
            camera.aspect = window.innerWidth / window.innerHeight;
            camera.updateProjectionMatrix();
            renderer.setSize(window.innerWidth, window.innerHeight);
        });

        init();
    </script>
</body>
</html>
